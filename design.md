# blockaft design
一个关于竞争与合作的游戏。



## 简介
一个纯2D平面的游戏。在一个比较巨大的2D空间中，玩家寻找矿块并采矿，获得资源。这其中可能获得的资源包括2类：一类是游戏资源，一类是奖励本身(kaft)。每轮周期之后，会根据奖励的比例，分配整个奖金池里面的奖金。

## 游戏空间

### 空间的大小
考虑一个1万x1万格的2D空间，如果每个格子用一个字节表示，这将消耗100MB来存储。不清楚这个量级对于EOS来说是否轻松。可以考虑各种优化方案，例如压缩或者随机种子等。

这整个空间构成游戏的地图。如果不采取特别的方法，所有玩家从始至终就知道整个地图的所有细节。需要找到合适的办法才能把地图状态保存为私密数据，只向玩家们分别发送他们附近的地图状态。

（具体大小可以再根据整体设计调整。）

### 行走速度
玩家在游戏中按一定速度行走，例如每0.5秒走一个格子。这个速度大致是一个RPG游戏中的正常行走速度，而且0.5秒正好也是eos出块的周期。按这个速度，玩家走完地图的一个边需要花费5000秒，也就是1小时23分钟多一点。

可以考虑有更快的行走方式。例如，如果在游戏中获得马匹。或者制作车辆、铁路。

### 游戏节奏
作为小游戏，其实只有2种选择，一种是时间长期的，人可以不用老是操作的，这种做出来会是挂机类游戏；另一种是相对短时间周期的，例如15分钟，30分钟内结束游戏，这种情况下，玩家需要一直紧张操作，类似王者荣耀这样。

考虑到游戏性和展示性，拟选用后者。游戏时间在15分钟左右。时间一到，即对本局进行结算。

### 地形
简单起见，地形的分类大致如此：
- 平地：平地可能有不同的外貌，但本质是一样的：可以畅通无阻。
    - 泥土
    - 沙地
    - 草地
- 资源块：实际上是在平地的基础之上附加了资源。资源可以有不同用处。在被采完之前，它们都会阻挡通行。资源被采完之后，露出本身的平地，变成畅通。
    - 矿：采集得到游戏奖励（kaft）本身，还可能会爆出一些特别的道具
    - 树木：采集得到木材
    - 石头：采集得到石头+金属

## 生产
### 建厂
玩家可以使用收集的游戏资源建造工厂。建造工厂的意义：
- 建造工厂需要消耗玩家手里的kaft和资源
- 工厂建造完成之后，可以加工kaft变成锁定的kaft（具有相同的结算功效），这会导致kaft数量增加
- 工厂会占用空间，需要用空地建造，建造后相应空间不能通行
- 工厂生产有生产效率，需要花费时间和kaft，所有人都可以预约下一生产周期的订单，安排生产谁的订单，是由出价的kaft竞价决定的
- 工厂的建造者可以分得一部分的kaft抽成

### 采集
无论是什么类型的资源，采集时间都是一样的，在1秒内（2个出块周期）完成（也可以考虑相对多个的周期，并通过加成可以减小，但不要过久）。但是根据每个采集者的加成不同，采集获得的是不同的。加成通过采集kaft块时随机获得的道具造成。

如果有多个玩家在同一个出块周期对同一个资源块进行采集，这里考虑几种方案：一是根据收到请求的时间先后，先收到的请求采集成功，其它失败；二是对同一个周期内所有参与采集的玩家进行一定规则的分配，例如全部分给一个随机玩家；或者平均分配等。这里可能还涉及到一些需要确认的EOS DApp开发细节。

### 道具
采集树木时有可能获得对采集树林效果加成的道具；同样适用于石头和kaft。还有一些道具作用大致是加快采集效率、行走效率等。

### 交易
玩家手里的资源，无论木头、石头、kaft（未加工）、道具（未使用）都可以挂单以kaft的形式交易。这是一种合作机制。通过这种方式使得资源得到更优的分配。

## 游戏的整体概貌
游戏在最外层看起来像是一个有奖池的竞技/赌博游戏。开发者首先放入5个eos（数量只为讨论，后同）在奖池，每位玩家投入1个eos参赛，需要至少5个位参赛玩家，才能开始一局（也可能一局开始之前已经有20个或更多玩家参赛）。游戏开始时，奖池中的数量是原奖池中数量+本局参赛者的所有参赛费。（例如本例中就是5+5=10个eos）游戏结束的条件是，当游戏的倒计时结束（例如15分钟）。游戏结束时，根据所有玩家手里的kaft数量（原始kaft+锁定kaft）的总量排名结算。前3名的玩家可以按100:50:20比例分得奖池中45%的eos，剩下的一半留在奖池中，还有5%划给开发者。对于大于5位玩家的局，这会造成奖池累积的eos越来越多。

## 随机
随机性只要大致追求就可以了。例如，由前100个区块的打包时间、打包的第1个交易的hash等来生成一个种子。
### 生成地图
kaft块可以考虑由3级随机生成。例如，首先确定最大级别的分块里面，应该如何分布各种块的数量；然后确定每一个这种分块里面的中级别块中如何分布；最后是对每个中级别分块，再来随机决定其内部每个格子如何分配。
其它资源块，如树林、石头，可以考虑造成一定的群簇性。也就是不是纯随机散点的方式，而是总体上会按一大群、一小群这样有一定聚集性的形式存在。

## 功能
需要的主要功能：
- 随机地图生成算法
- 地图数据展示为游戏中的场景
- 人物展示和控制（键盘上下左右，鼠标点击地图格子移动）
- 对资源的采集操作（面向资源键盘空格，鼠标点击资源）
- 游戏数据顶部展示
- 道具市场窗口界面
